<!DOCTYPE HTML>
<html class="no-js" lang="zh-CN">
<head>
    <!--[if lte IE 9]>
<meta http-equiv="refresh" content="0;url=http://yoursite.com/warn.html">
<![endif]-->
<meta charset="utf-8">

<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
<meta http-equiv="mobile-agent" content="format=html5; url=http://yoursite.com">
<meta name="author" content="liaofeic">
<link rel="stylesheet" href="/css/SimpleStyle.min.css" type="text/css">

<link rel="shortcut icon" href="/images/favicon.png">


<title>ajax详解 - Alex&#39;s Blog</title>

<meta name="keywords" content="undefined">

<meta name="description " content="hexo,个人博客,前端技术,javascript,html,css,angular,ionic,jquery">

</head>
<body>
<div id="nav">
    <nav class="nav-menu">
        <a class="site-name current" href="/" title="world">world</a>
        <a class="site-index current" href="/"><i class="fa fa-home"></i><span>首页</span></a>
        <a href="/archives" title="归档"><i class="fa fa-archives"></i><span>归档</span></a>
        <!-- <a href="/tags" title="标签"><i class="fa fa-tags"></i><span>标签</span></a> -->
        <!-- custom single page of menus -->
        
        
        <a href="/tool" title="工具">
            <i class="fa fa-question-circle"></i>
            <span>工具</span>
        </a>
        
        
        <a href="/about" title="关于">
            <i class="fa fa-tags"></i>
            <span>关于</span>
        </a>
        
    </nav>
</div>

<div class="nav-user">
    <a class="btn-search" href="#"><i class="fa fa-search"></i></a>
    <a class="btn-read-mode" href="#"><i class="fa fa-sun-o"></i></a>
</div>

<div id="wrapper" class="clearfix">
    <div id="body">
        <div class="main" id="main">
            <div id="cover">
    <div class="cover-img"></div>
    <div class="cover-info">
        
        <h1 class="cover-siteName">code魔法</h1>
        <h3 class="cover-siteTitle">stayHungry</h3>
        <p class="cover-siteDesc">求知若饥,虚心若愚</p>
        <div class="cover-sns">
            
            <div class="btn btn-github">
                <a href="https://github.com/lfc625" target="_blank" title="github" ref="friend">
                    <i class="fa fa-github"></i>
                </a>
            </div>
            
        </div>
    </div>
</div>
            <div class="page-title">
    <ul>
        <li><a href="/">最新</a></li>
        
            
                <li class="">
                    <a href="/categories/tech-notes" data-name="技术">技术</a>
                </li>
            
                <li class="">
                    <a href="/categories/humanities" data-name="人文">人文</a>
                </li>
            
                <li class="">
                    <a href="/categories/life" data-name="生活">生活</a>
                </li>
            
                <li class="">
                    <a href="/categories/others" data-name="其他">其他</a>
                </li>
            
        
        <li class="page-search">
    
</li>

    </ul>
</div>
<div class="main-inner">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
        <div class="post-header">
            <!-- <div class="post-author clearfix">
                <a class="avatar fleft" href="undefined" target="_blank">
                    <img width="48" src="undefined" alt="avatar"/>
                </a>
                <p><span class="label">作者</span>
                    <a href="undefined" target="_blank">undefined</a>
                    <span title="最后编辑于2016-02-11">2016-02-11</span>
                </p>
                <p>undefined</p>
            </div> -->
            <h2 class="post-title">AJAX详解</h2>
            <!-- <div class="post-meta">本文总共3736个字 | 您是第<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>位看到它们的小伙伴</div> -->
        </div>
        <div class="post-content markdown-body">
            <p>XMLHttpRequest对象（XHR）<br>var request = new XMLHttpRequest();<br>HTTP请求<br>计算机通过网络进行通信的规则 是一种无状态协议；</p>
<p>一个完整的HTTP请求</p>
<p>1建立TCP链接<br>2浏览器向服务器发送请求命令<br>3发送请求头信息<br>4服务器应答<br>5发送应答头信息<br>6服务器向浏览器发送数据<br>7关闭TCP连接</p>
<p>请求由4部分组成<br>1Http请求的方法或者动作get post<br>2Url<br>3请求头<br>4请求体<br>响应<br>1数字和文字的状态码<br> 1XX 信息类<br> 2XX 成功<br> 3XX 重定向<br> 4XX 客户端错误<br> 5XX 服务器错误<br> Found 引用的文档不存在</p>
<p>2响应头<br>3响应体<br>get：一般用来获取信息 使用URL传递参数 一般2000个字符<br>post 一般修改服务器上的资源。对发送的信息无限制</p>
<p>XMLHttpRequest的常用方法<br>open(method,url,async) 请求同步/异步<br>send(string)<br>responseText<br>responseXml<br>status<br>statusText<br>getAllResponseHeader()<br>getResponseHeader()<br>readyState<br> 0 请求未初始化 open未调用<br> 1 连接已经建立好，open已经调用<br> 2 请求已经接收 头信息<br> 3 请求处理中 响应主体信息<br> 4 请求已经完成，响应也完成</p>
<p>原生的ajax</p>
<script>
document.getElementById("search").onclick = function() {
    var request = new XMLHttpRequest();
    request.open("GET", "server.php?number=" + document.getElementById("keyword").value);
    request.send();
    request.onreadystatechange = function() {
        if (request.readyState===4) {
            if (request.status===200) { 
                document.getElementById("searchResult").innerHTML = request.responseText;
            } else {
                alert("发生错误：" + request.status);
            }
        } 
    }
}

document.getElementById("save").onclick = function() { 
    var request = new XMLHttpRequest();
    request.open("POST", "server.php");
    var data = "name=" + document.getElementById("staffName").value 
                      + "&number=" + document.getElementById("staffNumber").value 
                      + "&sex=" + document.getElementById("staffSex").value 
                      + "&job=" + document.getElementById("staffJob").value;
    request.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    request.send(data);
    request.onreadystatechange = function() {
        if (request.readyState===4) {
            if (request.status===200) { 
                document.getElementById("createResult").innerHTML = request.responseText;
            } else {
                alert("发生错误：" + request.status);
            }
        } 
    }
}
</script>






<p>JSON格式<br>｛<br>    staff:[<br>    {……},{……..},{……}<br>   ]<br>｝<br>数字<br>字符串<br>逻辑值<br>数组<br>对象<br>null</p>
<p>解析JSON</p>
<p>eval不但解析JSON字符串还会执行里面的一些方法。非常危险</p>
<p>JSON.parse 会检测json字符串是否合法，推荐使用<br>在线校验jsonlint.com</p>
<p>Jquery AJAX</p>
<p>$.ajax</p>
<p>type: 类型get/post<br>url<br>data 对象POST<br>dataType:json<br>success:是一个方法<br>error:XMLHttpRequest对象也传入了</p>
<p>$(document).ready(function(){<br>    $(“#search”).click(function(){<br>        $.ajax({<br>                type: “GET”,<br>            url: “<a href="http://127.0.0.1:8080/ajaxdemo/serverjson2.php?number=" target="_blank" rel="external">http://127.0.0.1:8080/ajaxdemo/serverjson2.php?number=</a>“ + $(“#keyword”).val(),<br>            dataType: “json”,<br>            success: function(data) {<br>                if (data.success) {<br>                    $(“#searchResult”).html(data.msg);<br>                } else {<br>                    $(“#searchResult”).html(“出现错误：” + data.msg);<br>                }<br>            },<br>            error: function(jqXHR){<br>               alert(“发生错误：” + jqXHR.status);<br>            },<br>        });<br>    });</p>
<pre><code>$(&quot;#save&quot;).click(function(){ 
    $.ajax({ 
            type: &quot;POST&quot;,     
        url: &quot;serverjson.php&quot;,
        data: {
            name: $(&quot;#staffName&quot;).val(), 
            number: $(&quot;#staffNumber&quot;).val(), 
            sex: $(&quot;#staffSex&quot;).val(), 
            job: $(&quot;#staffJob&quot;).val()
        },
        dataType: &quot;json&quot;,
        success: function(data){
            if (data.success) { 
                $(&quot;#createResult&quot;).html(data.msg);
            } else {
                $(&quot;#createResult&quot;).html(&quot;出现错误：&quot; + data.msg);
            }  
        },
        error: function(jqXHR){     
           alert(&quot;发生错误：&quot; + jqXHR.status);  
        },     
    });
});
</code></pre><p>});</p>
<p>跨域问题</p>
<p>不同域相互请求资源，就算跨域<br>javascript同源策略不允许跨域</p>
<p>如何解决 1.代理（后端写的）</p>
<pre><code>2.jsonp
      jsonp:&quot;callback&quot;
  只能处理get请求

3.XHR2
 目前只能支持到IE10 以上        
</code></pre>
        </div>
        <div class="post-tool">
            <a class="btn-thumbs-up" href="javascript:void(0);" data-cid="52" title="95">
                <i class="fa fa-thumbs-up" aria-hidden="true"></i> 打赏
            </a>
        </div>
        
        <div class="post-tags">标签：
            
            <a href="/tags/ajax/">ajax</a>
            
            <a href="/tags/web/">web</a>
            
        </div>
        
    </article>
    
    <p>本文代表个人观点，内容仅供参考。若有不恰当之处，望不吝赐教！</p>
    
    
<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    var disqus_config = function () {
        this.page.url = 'http://yoursite.com/2016/02/11/ajax/';
        this.page.identifier = '2016/02/11/ajax/';
    };
    (function () { // DON'T EDIT BELOW THIS LINE
        var d = document, disqus_shortname = '[object Object]', s = d.createElement('script');
        s.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>

</div>
<script src="/js/busuanzi.pure.mini.js" type="text/javascript"></script>

        </div><!-- end #main-->
    </div><!-- end #body -->
    <footer class="footer">
    <div class="footer-inner">
        <p>
            <!-- <a href="/about"  title="关于本站">关于本站</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp -->
            <!-- 自定义链接 -->
            <!-- <a href="/help" title="help" >急救中心</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <a href="/links" title="友情链接">友情链接</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <a href="/app" title="App下载">App下载</a> -->
            <a href="https://github.com/SunInfoFE" title="suninfo">suninfo</a>
            <a href="https://github.com/lfc625" title="lfc625">mygithub</a>
        </p>
        <!-- <p>
            本站点采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>，已建立<a href="/timeline" id="siteBuildingTime"></a>天<br/>
            ©2017 基于<a href="http://hexo.io" target="_blank">Hexo</a>搭建
            ，主题&nbsp<a href="https://github.com/tangkunyin/hexo-theme-jsimple" target="_blank">JSimple</a>
            ，作者<a href="https://www.tangkunyin.com" target="_blank">唐先森</a>
            ，Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
        </p> -->
        <p>
            ©2018 基于Hexo搭建 ，主题 JSimple ，作者LFC
        </p>
        

    </div>
</footer>
<script src="/js/InsightSearch.js" type="text/javascript"></script>
<script src="/js/SimpleCore.js" type="text/javascript"></script>

</div>
<div class="fixed-btn">
    <a class="btn-gotop" href="javascript:"> <i class="fa fa-angle-up"></i></a>
</div>
<script>
    $(function () {
        SimpleCore.init({
            buildingTime: '01/20/2018',
            current: $('.post-tags').length > 0 ? 'post' : 'archive',
            snsQRCode: '/images/sns-qrcode.png',
            donateImg: '/images/donate-qr.png',
        });
    });
</script>
</body>
</html>
